{"version":3,"sources":["uni-app:///main.js","webpack:///D:/pnbr-system/pnbr-front/pages/ShoppingCart/ShoppingCart.vue?5cfb","webpack:///D:/pnbr-system/pnbr-front/pages/ShoppingCart/ShoppingCart.vue?2900","webpack:///D:/pnbr-system/pnbr-front/pages/ShoppingCart/ShoppingCart.vue?f2c6","webpack:///D:/pnbr-system/pnbr-front/pages/ShoppingCart/ShoppingCart.vue?beb8","uni-app:///pages/ShoppingCart/ShoppingCart.vue","webpack:///D:/pnbr-system/pnbr-front/pages/ShoppingCart/ShoppingCart.vue?9945","webpack:///D:/pnbr-system/pnbr-front/pages/ShoppingCart/ShoppingCart.vue?c09b","webpack:///D:/pnbr-system/pnbr-front/wxs/number.wxs?8823","webpack:///D:/pnbr-system/pnbr-front/wxs/number.wxs?e1e9"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page"],"mappings":"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","file":"pages/ShoppingCart/ShoppingCart.js","sourcesContent":["import 'uni-pages';wx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/ShoppingCart/ShoppingCart.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./ShoppingCart.vue?vue&type=template&id=1ebf6306&filter-modules=eyJ3eHMiOnsidHlwZSI6InNjcmlwdCIsImNvbnRlbnQiOiIiLCJzdGFydCI6MzI0MywiYXR0cnMiOnsibW9kdWxlIjoid3hzIiwibGFuZyI6Ind4cyIsInNyYyI6Ii4uLy4uL3d4cy9udW1iZXIud3hzIn0sImVuZCI6MzI0M319&\"\nvar renderjs\nimport script from \"./ShoppingCart.vue?vue&type=script&lang=js&\"\nexport * from \"./ShoppingCart.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ShoppingCart.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../HBuilderX.3.3.5.20211229.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\n/* custom blocks */\nimport block0 from \"../../wxs/number.wxs?vue&type=custom&index=0&blockType=script&issuerPath=D%3A%5Cpnbr-system%5Cpnbr-front%5Cpages%5CShoppingCart%5CShoppingCart.vue&module=wxs&lang=wxs\"\nif (typeof block0 === 'function') block0(component)\n\ncomponent.options.__file = \"pages/ShoppingCart/ShoppingCart.vue\"\nexport default component.exports","export * from \"-!../../../../HBuilderX.3.3.5.20211229.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../HBuilderX.3.3.5.20211229.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../HBuilderX.3.3.5.20211229.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../HBuilderX.3.3.5.20211229.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../HBuilderX.3.3.5.20211229.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX.3.3.5.20211229.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./ShoppingCart.vue?vue&type=template&id=1ebf6306&filter-modules=eyJ3eHMiOnsidHlwZSI6InNjcmlwdCIsImNvbnRlbnQiOiIiLCJzdGFydCI6MzI0MywiYXR0cnMiOnsibW9kdWxlIjoid3hzIiwibGFuZyI6Ind4cyIsInNyYyI6Ii4uLy4uL3d4cy9udW1iZXIud3hzIn0sImVuZCI6MzI0M319&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../HBuilderX.3.3.5.20211229.full/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../HBuilderX.3.3.5.20211229.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../HBuilderX.3.3.5.20211229.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../HBuilderX.3.3.5.20211229.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX.3.3.5.20211229.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./ShoppingCart.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../HBuilderX.3.3.5.20211229.full/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../HBuilderX.3.3.5.20211229.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../HBuilderX.3.3.5.20211229.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../HBuilderX.3.3.5.20211229.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX.3.3.5.20211229.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./ShoppingCart.vue?vue&type=script&lang=js&\"","<template>\r\n<!--pages/ShoppingCart/ShoppingCart.wxml-->\r\n<view class=\"container\">\r\n  <view class=\"prod-list\">\r\n   <block v-for=\"(shopCartItem, shopCartItemIndex) in shopCartItemDiscounts\" :key=\"shopCartItemIndex\">\r\n    <view class=\"section\">\r\n    \t<image style=\"width: 130rpx;height: 130rpx;\" :src=\"shopCartItem.user.avatarImage?serverUrl+shopCartItem.user.avatarImage:'../../static/images/icon/head.png'\"></image>\r\n    \t<text>{{shopCartItem.user.username}}</text>\r\n    </view>\r\n\t<block v-for=\"(item, index) in shopCartItem.carts\" :key=\"index\">\r\n      <view class=\"prod-block\">\r\n       <view class=\"item\">\r\n         <view class=\"btn\">\r\n           <label>\r\n             <checkbox @tap=\"onSelectedItem\" :data-shopCartItemIndex=\"shopCartItemIndex\" :data-index=\"index\" :value=\"''+item.id\" :checked=\"item.checked\" color=\"#105c3e\"></checkbox>\r\n           </label>\r\n         </view>\r\n         <view class=\"prodinfo\">\r\n           <view class=\"pic\">\r\n             <image :src=\"serverUrl+item.image\"></image>\r\n           </view>\r\n           <view class=\"opt\">\r\n             <view class=\"prod-name\">{{item.title}}</view>\r\n             <view class=\"price-count\">\r\n               <view class=\"price\">\r\n                 <text class=\"symbol\">￥</text>\r\n                 <text class=\"big-num\">{{wxs.parsePrice(item.price)[0]}}</text>\r\n                 <text class=\"small-num\">.{{wxs.parsePrice(item.price)[1]}}</text>\r\n               </view>\r\n               <view class=\"m-numSelector\">\r\n                 <view @tap=\"onCountMinus\" class=\"minus\" :data-shopCartItemIndex=\"shopCartItemIndex\"  :data-index=\"index\"></view>\r\n                 <input type=\"number\" :value=\"item.num\" disabled></input>\r\n                 <view @tap=\"onCountPlus\" class=\"plus\" :data-shopCartItemIndex=\"shopCartItemIndex\" :data-index=\"index\"></view>\r\n               </view>\r\n             </view>\r\n           </view>\r\n         </view>\r\n       </view>\r\n      </view>\r\n    </block>\r\n\t<view style=\"height: 20rpx;\"></view>\r\n   </block>\r\n  </view>\r\n\r\n  <view class=\"empty\" v-if=\"shopCartItemDiscounts.length==0\">\r\n    <view class=\"img\">\r\n      <image src=\"/static/images/tabbar/ShoppingCart.png\"></image>\r\n    </view>\r\n    <view class=\"txt\">\r\n      您还没有添加任何商品哦~\r\n    </view>\r\n  </view>\r\n\r\n  <!-- 底部按钮 -->\r\n  <view class=\"cart-footer\" v-if=\"shopCartItemDiscounts.length>0\">\r\n    <view class=\"btn all\">\r\n      <label @tap=\"onSelAll\">\r\n        <checkbox :checked=\"allChecked\" color=\"#f7d731;\"></checkbox>全选</label>\r\n    </view>\r\n    <view class=\"btn del\" @tap=\"onDelBasket\">\r\n      <text>删除</text>\r\n    </view>\r\n    <view class=\"btn total\">\r\n      <view class=\"finally\">\r\n        <text>合计:</text>\r\n        <view class=\"price\">\r\n          <text class=\"symbol\">￥</text>\r\n          <text class=\"big-num\">{{wxs.parsePrice(finalMoney)[0]}}</text>\r\n          <text class=\"small-num\">.{{wxs.parsePrice(finalMoney)[1]}}</text>\r\n        </view>\r\n      </view>\r\n      <view class=\"total-msg\" v-if=\"subtractMoney>0\">\r\n        总额:￥{{wxs.toPrice(totalMoney)}} 立减:￥{{wxs.toPrice(subtractMoney)}}\r\n      </view>\r\n    </view>\r\n    <view class=\"btn settle\" @tap=\"toFirmOrder\">\r\n      <text>结算</text>\r\n    </view>\r\n  </view>\r\n  <!-- end 底部按钮 -->\r\n\r\n</view>\r\n</template>\r\n\r\n<script module=\"wxs\" lang=\"wxs\" src=\"../../wxs/number.wxs\"></script>\r\n\r\n<script>\r\n// pages/ShoppingCart/ShoppingCart.js\r\nvar http = require(\"../../utils/http.js\"); \r\nvar config = require(\"../../utils/config.js\");\r\nconst Big = require(\"../../utils/big.min.js\");\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      // picDomain: config.picDomain,\r\n      shopCartItemDiscounts: [\r\n\t\t  {\r\n\t\t\t  id: 0,\r\n\t\t\t  image: \"\",\r\n\t\t\t  num: 0,\r\n\t\t\t  price: 0,\r\n\t\t\t  skuId: 0,\r\n\t\t\t  title: \"\",\r\n\t\t\t  userId: 0\r\n\t\t  }\r\n\t  ],\r\n      finalMoney: 0,\r\n      totalMoney: 0,\r\n      subtractMoney: 0,\r\n      allChecked: true,\r\n\t  serverUrl: config.domain,\r\n\t  shopCartItem: [],\r\n    };\r\n  },\r\n\r\n  components: {},\r\n  props: {},\r\n\r\n  /**\r\n   * 生命周期函数--监听页面加载\r\n   */\r\n  onLoad: function (options) {},\r\n\r\n  /**\r\n   * 生命周期函数--监听页面初次渲染完成\r\n   */\r\n  onReady: function () {},\r\n\r\n  /**\r\n   * 生命周期函数--监听页面显示\r\n   */\r\n  onShow: function () {\r\n     //加载购物车\r\n    this.carList();\r\n    http.getCartCount(); //重新计算购物车总数量\r\n  },\r\n  methods: {\r\n\t  carList: function() {\r\n\t\t  uni.showLoading();\r\n\t\t  var params = {\r\n\t\t    url: \"/cart/list\",\r\n\t\t    method: \"POST\",\r\n\t\t\tneedToken: true,\r\n\t\t    data: {\r\n\t\t  \t  \"pageNum\": 1,\r\n\t\t  \t  \"pageSize\": 10\r\n\t\t    },\r\n\t\t    callBack: res => {\r\n\t\t      if (res.data.total > 0) {\r\n\t\t        // 默认全选\r\n\t\t        var shopCartItemDiscounts = res.data.list;\r\n\t\t        shopCartItemDiscounts.forEach(shopCartItemDiscount => {\r\n\t\t\t\t\tshopCartItemDiscount.carts.forEach(cart => {\r\n\t\t\t\t\t\tcart.checked = true;\r\n\t\t\t\t\t});\r\n\t\t        });\r\n\t\t        this.setData({\r\n\t\t          shopCartItemDiscounts: shopCartItemDiscounts,\r\n\t\t          allChecked: true\r\n\t\t        });\r\n\t\t      } else {\r\n\t\t        this.setData({\r\n\t\t          shopCartItemDiscounts: []\r\n\t\t        });\r\n\t\t      }\r\n\t\t  \r\n\t\t      this.calTotalPrice(); //计算总价\r\n\t\t  \r\n\t\t      uni.hideLoading();\r\n\t\t    }\r\n\t\t  };\r\n\t\t  http.request(params);\r\n\t  },\r\n    /**\r\n     * 去结算\r\n     */\r\n    toFirmOrder: function () {\r\n      var shopCartItemDiscounts = this.shopCartItemDiscounts;\r\n      var ShoppingCartIds = [];\r\n      shopCartItemDiscounts.forEach(shopCartItems=> {\r\n\t\t  var ShoppingCartProds = [];\r\n\t\t  var user = shopCartItems.user;\r\n\t\t  shopCartItems.carts.forEach(cart => {\r\n\t\t\t  if (cart.checked) {\r\n\t\t\t  \tShoppingCartProds.push(cart);\r\n\t\t\t  }\r\n\t\t  });\r\n\t\t  var shopCartItem = {\r\n\t\t\t  ShoppingCartProds: ShoppingCartProds,\r\n\t\t\t  user: user,\r\n\t\t\t  isAgent: shopCartItems.isAgent,\r\n\t\t\t  backgroundAgentId: shopCartItems.backgroundAgentId\r\n\t\t  }\r\n\t\t  ShoppingCartIds.push(shopCartItem);\r\n      });\r\n\r\n      if (!ShoppingCartIds.length) {\r\n        uni.showToast({\r\n          title: '请选择商品',\r\n          icon: \"none\"\r\n        });\r\n        return;\r\n      }\r\n\r\n      uni.setStorageSync(\"ShoppingCartIds\", ShoppingCartIds);\r\n      uni.navigateTo({\r\n        url: '/pages/submit-order/submit-order?orderEntry=0'\r\n      });\r\n    },\r\n\r\n    /**\r\n     * 全选\r\n     */\r\n    onSelAll: function () {\r\n      var allChecked = this.allChecked;\r\n      allChecked = !allChecked; //改变状态\r\n\r\n      var shopCartItemDiscounts = this.shopCartItemDiscounts;\r\n\r\n      for (var i = 0; i < shopCartItemDiscounts.length; i++) {\r\n\t\t  var carts = shopCartItemDiscounts[i].carts;\r\n\t\t  for (var i = 0; i < carts.length; i++) {\r\n\t\t\t  var cItems = carts[i];\r\n\t\t\t  cItems.checked = allChecked;\r\n\t\t  }\r\n      }\r\n\r\n      this.setData({\r\n        allChecked: allChecked,\r\n        shopCartItemDiscounts: shopCartItemDiscounts\r\n      });\r\n      this.calTotalPrice(); //计算总价\r\n    },\r\n\r\n    /**\r\n     * 每一项的选择事件\r\n     */\r\n    onSelectedItem: function (e) {\r\n\t  var shopCartItemIndex = e.currentTarget.dataset.shopCartItemIndex;\r\n      var index = e.currentTarget.dataset.index; // 获取data- 传进来的index\r\n\r\n      var shopCartItemDiscounts = this.shopCartItemDiscounts; // 获取购物车列表\r\n\r\n      var checked = shopCartItemDiscounts[shopCartItemIndex].carts[index].checked; // 获取当前商品的选中状态\r\n\r\n      shopCartItemDiscounts[shopCartItemIndex].carts[index].checked = !checked; // 改变状态\r\n\r\n      this.setData({\r\n        shopCartItemDiscounts: shopCartItemDiscounts\r\n      });\r\n      this.checkAllSelected(); //检查全选状态\r\n\r\n      this.calTotalPrice(); //计算总价\r\n    },\r\n\r\n    /**\r\n     * 检查全选状态\r\n     */\r\n    checkAllSelected: function () {\r\n      var allChecked = true;\r\n      var shopCartItemDiscounts = this.shopCartItemDiscounts;\r\n      var flag = false;\r\n\r\n      for (var i = 0; i < shopCartItemDiscounts.length; i++) {\r\n\t\t  var carts = shopCartItemDiscounts[i].carts;\r\n\t\t  for (var i = 0; i < carts.length; i++) {\r\n\t\t\t  var cItems = carts[i];\r\n\t\t\t  if (!cItems.checked) {\r\n\t\t\t    allChecked = !allChecked;\r\n\t\t\t    flag = true;\r\n\t\t\t    break;\r\n\t\t\t  }\r\n\t\t\t   if (flag) {\r\n\t\t\t     break;\r\n\t\t\t   }\r\n\t\t  }\r\n      }\r\n      this.setData({\r\n        allChecked: allChecked\r\n      });\r\n    },\r\n\r\n    /**\r\n     * 计算购物车总额\r\n     */\r\n    calTotalPrice: function () {\r\n      var shopCartItemDiscounts = this.shopCartItemDiscounts;\r\n\t  var shopCartItem = [];\r\n      var finalMoney = 0;\r\n      for (var i = 0; i < shopCartItemDiscounts.length; i++) {\r\n        var cItems = shopCartItemDiscounts[i].carts;\r\n\t\tfor (var j = 0; j < cItems.length; j++) {\r\n\t\t\tvar cart = cItems[j]\r\n\t\t\tif (cart.checked) {\r\n\t\t\t  shopCartItem.push(cart);\r\n\t\t\t  finalMoney+= cart.price*cart.num;\r\n\t\t\t}\r\n\t\t}\r\n       }\r\n      this.setData({\r\n            finalMoney: finalMoney,\r\n            totalMoney: finalMoney,\r\n            subtractMoney: 0,\r\n\t\t\tshopCartItem: shopCartItem\r\n      });\r\n    },\r\n\r\n    /**\r\n     * 减少数量\r\n     */\r\n    onCountMinus: function (e) {\r\n\t var shopCartItemIndex = e.currentTarget.dataset.shopCartItemIndex;\r\n     var index = e.currentTarget.dataset.index;\r\n     var shopCartItemDiscounts = this.shopCartItemDiscounts;\r\n\t var prodCount = shopCartItemDiscounts[shopCartItemIndex].carts[index].num;\r\n      if (prodCount > 1) {\r\n        this.updateCount(shopCartItemDiscounts,shopCartItemIndex,index, prodCount-1);\r\n\t\treturn;\r\n      }else {\r\n\t\t  uni.showToast({\r\n\t\t    title: '已经最少了',\r\n\t\t    icon: \"none\"\r\n\t\t  });\r\n\t  }\r\n    },\r\n\r\n    /**\r\n     * 增加数量\r\n     */\r\n    onCountPlus: function (e) {\r\n\t  var shopCartItemIndex = e.currentTarget.dataset.shopCartItemIndex;\r\n      var index = e.currentTarget.dataset.index;\r\n      var shopCartItemDiscounts = this.shopCartItemDiscounts;\r\n      this.updateCount(shopCartItemDiscounts,shopCartItemIndex, index, shopCartItemDiscounts[shopCartItemIndex].carts[index].num+1);\r\n    },\r\n\r\n    /**\r\n     * 改变购物车数量接口\r\n     */\r\n    updateCount: function (shopCartItemDiscounts,shopCartItemIndex, index, prodCount) {\r\n      var ths = this;\r\n      uni.showLoading({\r\n        mask: true\r\n      });\r\n      var params = {\r\n        url: \"/cart\",\r\n        method: \"PUT\",\r\n\t\tneedToken: true,\r\n        data: {\r\n          num: prodCount,\r\n          id: shopCartItemDiscounts[shopCartItemIndex].carts[index].id\r\n        },\r\n        callBack: function (res) {\r\n          shopCartItemDiscounts[shopCartItemIndex].carts[index].num = prodCount;\r\n          ths.setData({\r\n            shopCartItemDiscounts: shopCartItemDiscounts\r\n          });\r\n          ths.calTotalPrice(); //计算总价\r\n\r\n          uni.hideLoading();\r\n          http.getCartCount(); //重新计算购物车总数量\r\n        }\r\n      };\r\n      http.request(params);\r\n    },\r\n\r\n    /**\r\n     * 删除购物车商品\r\n     */\r\n    onDelBasket: function () {\r\n      var ths = this;\r\n      var shopCartItemDiscounts = this.shopCartItemDiscounts;\r\n      var ShoppingCartIds = [];\r\n\r\n      for (var i = 0; i < shopCartItemDiscounts.length; i++) {\r\n        var cItems = shopCartItemDiscounts[i].carts;\r\n        for (var j = 0; j < cItems.length; j++) {\r\n        \tvar cart = cItems[j]\r\n        \tif (cart.checked) {\r\n        \t  ShoppingCartIds.push(cart.id);\r\n        \t}\r\n        }\r\n      }\r\n\r\n      if (ShoppingCartIds.length == 0) {\r\n        uni.showToast({\r\n          title: '请选择商品',\r\n          icon: \"none\"\r\n        });\r\n      } else {\r\n        uni.showModal({\r\n          title: '',\r\n          content: '确认要删除选中的商品吗？',\r\n          confirmColor: \"#eb2444\",\r\n          success(res) {\r\n            if (res.confirm) {\r\n              uni.showLoading({\r\n                mask: true\r\n              });\r\n\t\t\t  ShoppingCartIds.forEach(ShoppingCartId => {\r\n\t\t\t\t  var params = {\r\n\t\t\t\t    url: \"/cart/\"+ShoppingCartId,\r\n\t\t\t\t    method: \"DELETE\",\r\n\t\t\t\t\tneedToken: true,\r\n\t\t\t\t    callBack: function (res) {\r\n\t\t\t\t      uni.hideLoading();\r\n\t\t\t\t    }\r\n\t\t\t\t  };\r\n\t\t\t\t  http.request(params);\r\n\t\t\t  });\r\n\t\t\t  ths.carList();\r\n            }\r\n          }\r\n\r\n        });\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n<style>\r\n@import \"./ShoppingCart.css\";\r\n</style>","import mod from \"-!../../../../HBuilderX.3.3.5.20211229.full/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../HBuilderX.3.3.5.20211229.full/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../HBuilderX.3.3.5.20211229.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../HBuilderX.3.3.5.20211229.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../HBuilderX.3.3.5.20211229.full/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../HBuilderX.3.3.5.20211229.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX.3.3.5.20211229.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./ShoppingCart.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../HBuilderX.3.3.5.20211229.full/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../HBuilderX.3.3.5.20211229.full/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../HBuilderX.3.3.5.20211229.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../HBuilderX.3.3.5.20211229.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../HBuilderX.3.3.5.20211229.full/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../HBuilderX.3.3.5.20211229.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX.3.3.5.20211229.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./ShoppingCart.vue?vue&type=style&index=0&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1648712950975\n      var cssReload = require(\"D:/HBuilderX.3.3.5.20211229.full/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  ","import mod from \"-!../../../HBuilderX.3.3.5.20211229.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-filter-loader/index.js!./number.wxs?vue&type=custom&index=0&blockType=script&issuerPath=D%3A%5Cpnbr-system%5Cpnbr-front%5Cpages%5CShoppingCart%5CShoppingCart.vue&module=wxs&lang=wxs\"; export default mod; export * from \"-!../../../HBuilderX.3.3.5.20211229.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-filter-loader/index.js!./number.wxs?vue&type=custom&index=0&blockType=script&issuerPath=D%3A%5Cpnbr-system%5Cpnbr-front%5Cpages%5CShoppingCart%5CShoppingCart.vue&module=wxs&lang=wxs\"","export default function (Component) {\n       if(!Component.options.wxsCallMethods){\n         Component.options.wxsCallMethods = []\n       }\n       \n     }"],"sourceRoot":""}